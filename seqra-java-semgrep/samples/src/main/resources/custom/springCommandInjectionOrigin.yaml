rules:
  - id: java.spring.command-injection
    languages:
      - java
    severity: ERROR
    message: Command line depends on a user provided value
    patterns:
      - pattern-inside: |
          @GetMapping("...")
          $RETURNTYPE $METHOD(..., String $FILEPATH, ...) {
            ...
          }
      - pattern: |
          ProcessBuilder $BUILDER = new ProcessBuilder($FILEPATH);
      - pattern-not-inside: |
          $PATTERN.matcher($FILEPATH).matches();
          ...

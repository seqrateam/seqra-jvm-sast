rules:
  - id: tainted-session-from-http-request
    message: >-
      Detected input from a HTTPServletRequest going into a session command, like `setAttribute`.
    languages: [java]
    severity: WARNING
    mode: taint
    pattern-sources:
      - patterns:
        - pattern: |
            (HttpServletRequest $REQ).$FUNC(...)
        - pattern-not: |
            (HttpServletRequest $REQ).getSession()
    pattern-sinks:
      - patterns:
        - pattern: (HttpServletRequest $REQ).getSession().$FUNC($NAME, $VALUE);
        - metavariable-regex:
            metavariable: $FUNC
            regex: ^(putValue|setAttribute)$
        - focus-metavariable: $VALUE
